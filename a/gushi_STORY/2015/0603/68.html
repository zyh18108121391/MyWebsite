<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />

<title>小房子-郑银华的专属网站_【学习心得】dedecms 如何调用栏目文章总数</title>
<meta name="keywords" content="学习,心得,dedecms,如何,调用,栏目,文章,总数,在" />
<meta name="description" content="在用dedecms制作网站到时候，在某些需求下，需要在栏目文章列表调用本栏目总文章数目，但是dede标签中并没有提供。下面介绍处理办法。 第一种：根据所在栏目ID自动判断显示所在栏目的文章数 ([field:ID runphp=yes] @me = GetTotalArc(@me);[/field:ID]) 第" />

<link href="/templets/default/style.css" rel="stylesheet" type="text/css" />
<link href="/templets/default/photostyle.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/templets/default/pic.js"></script>
<script type="text/javascript" src="/templets/default/runphoto.js"></script>
<script type="text/javascript">

function mover_HOME(){
	document.getElementById("HOME").style.marginTop="15px";	
}
function mout_HOME(){
	document.getElementById("HOME").style.marginTop="0px";
}

function mover_STORY(){
	document.getElementById("STORY").style.marginTop="15px";	
}
function mout_STORY(){
	document.getElementById("STORY").style.marginTop="0px";
}

function mover_PHOTO(){
	document.getElementById("PHOTO").style.marginTop="15px";	
}
function mout_PHOTO(){
	document.getElementById("PHOTO").style.marginTop="0px";
}

function mover_VIDEO(){
	document.getElementById("VIDEO").style.marginTop="15px";	
}
function mout_VIDEO(){
	document.getElementById("VIDEO").style.marginTop="0px";
}

function mover_ABOUT(){
	document.getElementById("ABOUT").style.marginTop="15px";	
}
function mout_ABOUT(){
	document.getElementById("ABOUT").style.marginTop="0px";
}
</script>

</head>

<body>
<div class="bd">

<link rel="shortcut icon" href="favicon.ico" />
<!--头部开始-->
<div id="head">
	<!--悬浮模块-->	
	<div id="float_dh">
		<div id="Photos_dh">
		<a href="/a/3Dxiangce/" title="进入3D相册">3D相册</a>
		</div>
		
		<div id="Messages_dh">
		<a href="/a/liuyanqiang/" title="进入留言墙">留言墙</a>
		</div>
	</div>
	<div id="float_fx">
		<script type="text/javascript" src="/templets/default/js/qqfx.js"></script>
		<script src="http://qzonestyle.gtimg.cn/qzone/app/qzlike/qzopensl.js#jsdate=20111201" charset="utf-8"></script>
	</div>
	<!--悬浮模块结束-->	
	
		<div id="left"><a class="log" href="/"></a></div>
		<div  id="log_words">小房子-这里属于郑银华的另一片内心世界！</div>
		<div id="dh_list">
		<ul>
			<li id="HOME" onmouseover="mover_HOME()" onmouseout="mout_HOME()" class="button dh"><a href="/"><div class="li-a1">主页</div><div class="li-a2">HOME</div></a></li>			
			<li id="STORY" onmouseover="mover_STORY()" onmouseout="mout_STORY()"  class="button dh"><a href="/a/gushi_STORY/"><div class="li-a1">故事</div><div class="li-a2">STORY</div></a></li>
			<li id="PHOTO" onmouseover="mover_PHOTO()" onmouseout="mout_PHOTO()" class="button dh"><a href="/a/xiangce_PHOTO/"><div class="li-a1">相册</div><div class="li-a2">PHOTO </div></a></li>
			<li id="VIDEO" onmouseover="mover_VIDEO()" onmouseout="mout_VIDEO()" class="button dh"><a href="/a/shipin_VIDEO/"><div class="li-a1">视频</div><div class="li-a2">VIDEO</div></a></li>
			<li id="ABOUT" onmouseover="mover_ABOUT()" onmouseout="mout_ABOUT()" class="button dh"><a href="/a/guanyu_ABOUT/"><div class="li-a1">关于</div><div class="li-a2">ABOUT</div></a></li>
		</ul>
		</div>
  </div>
  <div id="hr"></div>
  <!--头部结束-->

  <div id="content">
  	<div id="article_content">
	
		<div id="article_left">
			<div id="NewStory">
				<div id="header">
				<span id="head_left">最新动态-NEW STORY</span>
				</div>
				<div id="article_news">
					<ul>
						<li><a href="/a/gushi_STORY/2015/0605/69.html" title="【学习心得】如何在网站中添加QQ">【学习心得】如何在网站中添加QQ...</a></li>
<li><a href="/a/gushi_STORY/2015/0603/68.html" title="【学习心得】dedecms 如何调用栏">【学习心得】dedecms 如何调用栏...</a></li>
<li><a href="/a/xiangce_PHOTO/2015/0602/67.html" title="【游戏人生】最爱LOL德莱文金牌">【游戏人生】最爱LOL德莱文金牌...</a></li>
<li><a href="/a/gushi_STORY/2015/0602/66.html" title="【游戏人生】第一次玩LOL居然是">【游戏人生】第一次玩LOL居然是...</a></li>
<li><a href="/a/gushi_STORY/2015/0602/65.html" title="【技术心得】域名及网站如何进行">【技术心得】域名及网站如何进行...</a></li>

					</ul>
				</div>
			</div>
			<div id="RecommendImg">
				<div id="header">
				<span id="head_left">推荐图文-RECOMMENT PHOTO </span>
				<span id="head_right"><a href="/a/xiangce_PHOTO/">MORE+</a></span>
				</div>
				<div id="article_imgs">
					<ul>
						<li><a href="/a/xiangce_PHOTO/2015/0602/67.html" title="【游戏人生】最爱LOL德莱文金牌"><img src='/uploads/allimg/150602/1-150602162SDJ.png' border='0' width='120' height='120' alt='【游戏人生】最爱LOL德莱文金牌主播'></a></li>
<li><a href="/a/xiangce_PHOTO/2015/0302/51.html" title="七中合照-海内存知己天涯若比邻"><img src='/uploads/allimg/150302/1-1503021H126.jpg' border='0' width='120' height='120' alt='七中合照-海内存知己天涯若比邻'></a></li>
<li><a href="/a/xiangce_PHOTO/2015/0302/50.html" title="儿时回忆-转盘画糖你可吃过"><img src='/uploads/allimg/150302/1-1503021G005.jpg' border='0' width='120' height='120' alt='儿时回忆-转盘画糖你可吃过'></a></li>
<li><a href="/a/xiangce_PHOTO/2015/0201/39.html" title="最佳缘分-三人同年同月同日生"><img src='/uploads/allimg/150201/1-150201201000-lp.jpg' border='0' width='120' height='120' alt='最佳缘分-三人同年同月同日生'></a></li>

					</ul>
				</div>
			</div>
		</div><!--article_left end-->
		
		<div id="article_right">
			<div id="header">
				<span id="head_left">>>当前位置:<a href='http://localhost//'></a> > <a href='/a/gushi_STORY/'>故事-STORY</a> > </span>
			</div>
			<div id="article_abody">
			<div id="article_title">【学习心得】dedecms 如何调用栏目文章总数</div>
			<div id="article_timeandmore">点击数：<strong style="color:#CCCCCC"><script src="/plus/count.php?view=yes&aid=68&mid=1" type='text/javascript' language="javascript"></script></strong>次 更新时间：<strong style="color:#CCCCCC">2015-06-03 15:03</strong></div>
			<div id="article_bodyContent">
			<div>
	在用dedecms制作网站到时候，在某些需求下，需要在栏目文章列表调用本栏目总文章数目，但是dede标签中并没有提供。下面介绍处理办法。<br />
	<br />
	第一种：根据所在栏目ID自动判断显示所在栏目的文章数&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	([field:ID runphp=&#39;yes&#39;] @me = GetTotalArc(@me);[/field:ID])&nbsp;</div>
<div>
	第二种：指定栏目ID&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	{dede:sql sql=&quot;SELECT count( ID ) AS c FROM dede_archives where typeid = 栏目id &quot;} &nbsp; &nbsp;</div>
<div>
	本月更新：[field:c /]篇 {/dede:sql}&nbsp;</div>
<div>
	第三种：DedeCMS栏目文章数量统计调用，栏目名称按照文章数量排列&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	{dede:sql sql=&#39;SELECT d.typename,d.id,count(da.id) &nbsp; &nbsp;</div>
<div>
	as heji FROM dede_arctype d left join dede_archives &nbsp; &nbsp;</div>
<div>
	da on dda.typeid=d.id where d.reid=0 group by d.typename order by heji desc limit 0,8;&#39;} &nbsp;&nbsp;</div>
<div>
	&lt;&lt;/span&gt;span class=&quot;text_1&quot;&gt;&lt;&lt;/span&gt;span class=&quot;count&quot;&gt;[[field:heji/]篇]&lt;/&lt;/span&gt;span&gt; &nbsp;</div>
<div>
	&lt;&lt;/span&gt;a href=&quot;http://www.dedecmsmuban.com/plus/list.php &nbsp;&nbsp;</div>
<div>
	?tid=[field:id/]&quot;&gt;[field:typename/]共投递稿件&lt;/&lt;/span&gt;a&gt;&lt;/&lt;/span&gt;span&gt;&lt;&lt;/span&gt;br /&gt; {/dede:sql} &nbsp;&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	第四种：&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	修改include/common.func.php &nbsp;</div>
<div>
	在最后加入代码： &nbsp;</div>
<div>
	//*****统计栏目文章数</div>
<div>
	&nbsp;</div>
<div>
	function GetTotalArc($tid) &nbsp;&nbsp;</div>
<div>
	{ &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	global $dsql; &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	$sql = GetSonIds($tid); &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	$row = $dsql-&gt;GetOne(&quot;Select count(id) as dd From dede_archives where typeid in({$sql})&quot;); &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	return $row[&#39;dd&#39;]; }&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	在htm 最下方添加：&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	{dede:channel type=&#39;top&#39; row=&#39;8&#39;}&nbsp;</div>
<div>
	&lt;&lt;/span&gt;LI&gt;[field:typename/](&lt;&lt;/span&gt;span&gt;&nbsp;</div>
<div>
	[field:ID runphp=&#39;yes&#39;] @me = GetTotalArc(@me);&nbsp;</div>
<div>
	[/field:ID]&lt;/&lt;/span&gt;span&gt;)&lt;/&lt;/span&gt;LI&gt;{/dede:channel}&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	如果想调用副栏目的数量 就是&nbsp;</div>
<div>
	//*****统计栏目文章数</div>
<div>
	&nbsp;</div>
<div>
	function GetTotalArc($tid2){ &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	global $dsql; &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	$sql = GetSonIds($tid2); &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	$row = $dsql-&gt;GetOne(&quot;Select count(id) as dd From dede_archives where typeid2 in({$sql})&quot;); &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	return $row[&#39;dd&#39;]; }&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	HTM页面不变</div>
<div>
	&nbsp;</div>
<div>
	现在我们来说说动态调用栏目文章数：</div>
<div>
	&nbsp;</div>
<div>
	动态调用主要针对当前列表页的栏目，而当前的栏目是动态的，因此可以利用type标签调用一个函数就行了。</div>
<div>
	&nbsp;</div>
<div>
	要调用函数就得增加函数，打开include/common.func.php，在其中任一行( 的中间任一行)中加上如下函数。</div>
<div>
	&nbsp; &nbsp; function dynamic_num($current_id){&nbsp;</div>
<div>
	&nbsp; &nbsp; global $dsql;&nbsp;</div>
<div>
	&nbsp; &nbsp; $t_num = $dsql-&gt;GetOne(&quot;select count(*) as num from `dede_archives` where typeid=&#39;$current_id&#39;&quot;);&nbsp;</div>
<div>
	&nbsp; &nbsp; if(is_array($t_num)){&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp;return &quot;本栏目共有&quot;.$t_num[num].&quot;篇文章&quot;;&nbsp;</div>
<div>
	&nbsp; &nbsp; }else{&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp;return &quot;本栏目共有0篇文章&quot; ;&nbsp;</div>
<div>
	&nbsp; &nbsp; }&nbsp;</div>
<div>
	&nbsp; &nbsp; }</div>
<div>
	&nbsp;</div>
<div>
	济宁网站优化在列表页中这样调用:</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; {dede:type}[field:id function=&quot;dynamic_num(@me)&quot; /]{/dede:type} &nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{dede:sql sql=&quot;SELECT count( * ) AS c FROM cmsxx_archives &nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WHERE pubdate &gt; UNIX_TIMESTAMP( CURDATE( ) ) &quot;}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div>
<div>
	&nbsp;</div>
<div>
	今日更新：[field:c/] 篇&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {/dede:sql}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {dede:sql sql=&quot;Select count(ID) as c From cmsxx_archives &nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE FROM_UNIXTIME(pubdate,&#39;%m&#39;)=month(curdate())&quot;}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	当月更新：[field:c/] 篇&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {/dede:sql}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {dede:sql sql=&quot;select count(*) as c from cmsxx_archives}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	共有文章：[field:c/] 篇&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {/dede:sql}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {dede:sql sql=&quot;select sum(click) as c from cmsxx_archives&quot;}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	总共阅读：[field:c/] 人次&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {/dede:sql}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {dede:sql sql=&quot;select count(mid) as c from cmsxx_member &quot;}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div>
<div>
	共有会员：[field:c/] 名&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {/dede:sql} &nbsp;</div>
<div>
	济宁seo还可以指定栏目ID，例如：</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; {dede:sql sql=&quot;select count(*) as c from cmsxx_archives where channel in(1,2,3,5,6,9)&quot;}&nbsp;</div>
<div>
	&nbsp; &nbsp; &nbsp; &nbsp;</div>
<div>
	&nbsp;</div>
<div>
	共有文章：[field:c/] 篇&nbsp;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; &nbsp; {/dede:sql}&nbsp;<br />
	<br />
	<strong>获取更多技术心得文章：</strong><br />
	<br />
	&nbsp; &nbsp;<a href="http://www.zhengyinhua.com/a/gushi_STORY/2015/0427/63.html">【网站优化】seo必不可少之锚文本链接&nbsp;如何做好锚文本？</a><br />
	<br />
	&nbsp; &nbsp;<a href="http://www.zhengyinhua.com/a/gushi_STORY/2015/0602/65.html">【技术心得】域名及网站如何进行备案</a><br />
	&nbsp; &nbsp;<br />
	<strong>小房子</strong>-郑银华的专属网站、一个温馨的世界，一颗温暖的内心。<br />
	&nbsp;</div>
<div>
	&nbsp;</div>

			</div>
			<div class="context">
				<ul>
					<li>上一篇：<a href='/a/gushi_STORY/2015/0602/66.html'>【游戏人生】第一次玩LOL居然是当年高考结束那天晚上</a> </li>
					<li>下一篇：<a href='/a/gushi_STORY/2015/0605/69.html'>【学习心得】如何在网站中添加QQ微信等分享按钮</a> </li>
				</ul>
			</div><!-- /context -->
			</div>
	
		</div><!--article_right end-->
	</div>
	
  </div><!--content end-->
  <div class="clear"></div>
<!---尾部开始---->
	<div id="hr2"></div>
	<div id="footer">
	<div class="center">
	<div id="footer_img"><a href="/" title="小房子-郑银华的专属网站"><img src="/templets/default/images/logfooter.png" /></a></div>
		<div id="footer_copy">
		<div class="footer_word">小房子</div>
			<ul>
				<li>联系电话：18108121391</li>
				<li><span class="qqtalk">QQ交谈:</span><span class="qqtalkimg"><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=390579684&site=qq&menu=yes"><img border="0" src="http://wpa.qq.com/pa?p=2:390579684:51" alt="点击这里给我QQ交谈" title="点击这里给我QQ交谈"/></a></span></li>
				<div class="clear"></div>
				<li><a href="/a/liuyanqiang/">给我留言<img src="/templets/default/images/messages.png"  width="20px" height="20px"/></a></li>
				<li>@2014-2015 版权所有</li>
			</ul>
		</div>
		<div id="footer_dh">
		<div class="footer_word">相关链接</div>
			<ul>
				<li><a href="/a/gushi_STORY/">故事-STORY</a></li>
				<li><a href="/a/xiangce_PHOTO/">相册-PHOTO</a></li>
				<li><a href="/a/shipin_VIDEO/">视频-VIDEO</a></li>
				<li><a href="/a/guanyu_ABOUT/">关于-ABOUT</a></li>
			</ul>
		</div>
		</div>
	</div>
<!--尾部结束-->
	
  </div>
</body>
</html>
